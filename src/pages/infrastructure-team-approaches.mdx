---
slug: "/blog/core-of-devops-processes-in-org"
date: "2021-11-21"
author: "Евгений"
keywords: devops,принципы девопс,скорость инфраструктуры,командные процессы
---
# Способы организации работ над инфраструктурой

<!-- cut -->
За много лет мне довелось повидать много различных моделей организации работ над инфраструктурой.
В этой статье я бы хотел бы систематизировать увиденное и описать вкратце когда и почему разные варианты стоит предпочесть другим.
Важно отметить что под инфраструктурой имеется ввиду работа с железом, облаком, хостингом и т.д., то что обычно называют DevOps.
Каждый раздел описывает одну модель, плюсы и минусы, риски и в каких случаях стоит предпочесть другим.
<!-- cut -->

<h2 id={"central-team"}><a href={"#central-team"}>Центральная команда</a></h2>

В такой модели есть одна команда которая разрабатывает инфраструктуру, а остальные команды ее потребляют.
Центральная команда имеет свои внутренние процессы и структуру, а так же внешние процессы для взаимодействия с другими командами.

![Центральная команда разработки инфраструктуры, которая взаимодействует с облаком и своими серверами.](../images/central-infra-team.png)

### Плюсы

* Так как есть центральная команда - инфраструктура максимально унифицирована, зоопарк минимальный.
* Происходит обмен знаниями внутри одной команды, и есть взаимозаменяемость инженеров.
* У центральных инфраструктурных сервисов, есть команда, которая натурально может их поддерживать.

### Минусы

* Часто является узким горлышком, т.к. все обращаются со своими запросами в одну команду.
* Может происходить конфликт приоритетов с локальными командами, потому что внутри команды, которая потребляет инфраструктуру,
есть свои приоритеты, которые могут противоречить центральным приоритетам, которым в свою очередь следует центральная команда.
* У команд которые потребляют инфраструктуру, может быть не развиты знания по работе с ней.

### Когда стоит использовать

Когда инфраструктуру могут потреблять многие команды, но при этом они делают очень похожие задачи.
Например, 10 инженерных команд делают один веб-проект и им нужно подымать шаблонные сервисы, тогда центральная команда работает хорошо, т.к. не допустит зоопарка на однотипных задачах.
Когда есть центральные сервисы которые должны потреблять другие команды. Например, CI или hashicorp vault.

### Когда не стоит использовать

Если в у каждой команды очень уникальная инфраструктура из-за требований, то центральная команда может работать плохо.
Точнее теряется смысл в центральной команде. Вы не будете получать те плюсы которые она дает, но при этом будет постоянные конфликты на фоне приоритетов.

### Какие проблемы придется решить

Центральной команде обязательно нужна система приоритизации работы. При этом
очень важно что бы эта система приоритизации была максимально прозрачна и понятная для тех, кому придется взаимодействовать с центральной командой.
Хорошо бы не упасть в ловушку "кто громче кричит, того и приоритеты". Рано или поздно такое случится, т.к. каждая команда стремиться оптимизировать
свои локальные приоритеты, и им не очень будет понятно почему их работа откладывается на попозже.

<h2 id={"infra-eng-in-team"}><a href={"#infra-eng-in-team"}>Инфраструктурный инженер в команду</a></h2>

В такой модели в каждой команде разработки, есть один или несколько человек, которые занимаются инфраструктурой.
Инфраструктурные инженеры полностью интегрированные в процессы конкретной команды.

![Команда в которую интегрированы инфраструктурные инженеры.](../images/infra-eng-in-team.png)

### Плюсы

* Нет конфликта приоритетов. Команда полностью внутри принимает решения о том что делать в первую очередь и что делать во вторую очередь.
* Локально решения принимаются быстро и так же быстро воплощаются в жизнь.

### Минусы

* В организациях где команд много - растёт зоопарк инструментов и подходов.
Нормальная ситуация когда в одной организации используются разные CI системы, системы виртуализации, подходы к разворачиванию и т.д.
* Обмен знаний минимален, а даже если он присутствует, то многое воспринимается больше как для информации, чем как призыв к действию.
* В масштабах организации делается много одинаковой работы.
* Инженеры в командах могут быть недогружённые, если нет постоянной инфраструктурной работы и она появляется от инициативы к инициативе.
* Построение системы в котором будет достигаться минимальный уровень качества для инфраструктуры требует отдельных усилий, как для установки процесса, так и для поддержания уровня.

### Когда стоит использовать

Когда специфика разработки такая, что она постоянно требует уникальной инфраструктуры, ее развития и поддержки.
Например, компания занимается построением своего облака, где в каждом сервисе присутствует элемент разработки, и построение инфраструктуры.

Когда в рамках организации много средних или мелких, раздробленных, не связанных между собой проектов.
В таком случае даже при наличии центральной команды инженер вероятнее всего будет работать в контексте конкретного проекта, так что бы учесть нужды конкретного проекта.
И проще всего интегрировать инженера в команду, хотя бы на начальных этапах, пока идет построение инфраструктуры.

### Когда не стоит использовать

Когда есть много команд, которые трудятся для достижения общей цели, например работают над одним проектом и при этом потребности всех команд примерно похожи.
В таком случае инфраструктурный инженер в каждой команде с большой долей вероятности будет делать всё по своему,
и в каждой из команд получается достаточно уникальная инфраструктура, которую сложно будет эволюционировать и поддерживать.

Когда из-за различных требований, например требований по безопасности, надо централизовать инфраструктуру,
так что бы можно было строить политики безопасности вокруг центральных компонентов.
Например, обязательно иметь центральную систему CI, котора должна иметь конкретную аутентификацию и конкретно настроенные билд агенты.

### Какие проблемы придется решить

Обмен знаниями. Часто в команды интегрируется один инженер который работает с инфраструктурой,
а значит он является основным источником знаний, о том как построена инфраструктура, как ее надо поддерживать и развивать.
При таком подходе может страдать взаимозаменяемость в командах.

Зоопарк решений и инструментов. Проблемой это становиться тогда, когда в организации появляется орган ответственный за какой-то минимальный уровень качества.
Например, отдел безопасности должен обеспечить минимальный уровень качества для любой инфраструктуры, которая строится внутри организации.
Такому отделу придется разбираться в достаточно уникально построенных архитектурах и подходах, что уже по себе не маленькая работа.
Так же надо будет понять набор действий в каждом выбранном подходе, что бы достичь того самого минимального качества и проконтролировать что это будет воплощенно в жизнь.

<h2 id={"infra-in-team"}><a href={"#infra-in-team"}>Инфраструктура интегрированная в команду</a></h2>

<h2 id={"mixed-approach"}><a href={"#mixed-approach"}>Комбинация вариантов</a></h2>
