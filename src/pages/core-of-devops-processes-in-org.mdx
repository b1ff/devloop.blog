---
slug: "/blog/core-of-devops-processes-in-org"
date: "2021-07-04"
author: "Евгений"
---
# Основополагающий принцип DevOps внутри организации

<!-- cut -->
Очень часто в организациях наблюдается ситуация, когда происходят локальные конфликты между разработчиками и отделами,
которые занимаются инфраструктурой. Впоследствии конфликты кому-то надо тушить. Так как меня часто привлекают для тушения
таких конфликтов, хотелось бы поделится виденьем того, из-за чего эти конфликты появляются и что нужно сделать,
по моему мнению, чтобы сильно уменьшить их количество.

## Как появлялся DevOps?

Все мы ведь знаем зачем было придумано такое маркетинговое название как DevOps. Вдруг кто не знает...
<!-- cut -->
(_Я догадываюсь, как раздражают вступительные слова об одном и том же в текстах как этот.
Например, давайте в сотый раз нарисуем корабль с контейнерами или набор микро какашек в статье про микросервисы,
но тут история нужна для дальнейшего повествования, а не, чтобы познакомить в сотый раз с тем, что и так все знают_)
Так вот, вдруг кто не знает, в далёком 2009 движение DevOps было призвано разорвать метание экскрементов
между админами и командами разработки в процессе доставки продукта до пользователя.
Проблема выходила из процесса развертывания приложений в то время. Зачастую команда разработки результатом
своей деятельности давала некий артефакт (например, .jar файл, .dll, .exe, в некоторых случаях архив с исходным кодом).
Далее этот артефакт уходил админам, и они должны были запустить его на каком-то окружении,
будь то продакшн для пользователей или тестовый стенд. И вот тут начиналось самое интересное,
админы не могут запустить - возвращают артефакт разработчикам, разработчики не знают,
что там админы делали — возвращают админам со словами “сами вы ***, вот это пробовали?”.
И так по кругу, пока артефакт не заведется или же у кого-то не кончится терпение.
Конечно же, ситуации, которые переходили в перебрасывание, не заканчивались одним лишь развёртыванием,
дальше следовала нагрузка, ошибки, логи и прочие радости эксплуатации,
в котором одни команды перебрасывали “информацию” другим командам,а те в свою очередь отвечали другой “информацией” в зад.

И тогда кто-то сказал “хватит!” и придумал маркетинговое название процессу, который положил бы конец чемпионату
по самому меткому перебрасыванию ответственности в другую команду. Назвали это DevOps, что вкратце означает следующее:
“команды разработки, давайте вы больше будете вникать в то, как ваше приложение запускается в реальных средах
и следить за его стабильностью и потребностями, а команды админов со своей стороны,
давайте вы научитесь понимать потребности команд разработки и научитесь
автоматизировать с учётом спроса в рамках контекста текущей организации”.

## Как на практике это должно было работать?

С помощью наших любимых разговоров друг с другом в правильное время.
Если упрощать, то команда вместо того, чтобы приходить и говорить:

_“я сделаль, возьми мое язделие и понеси пользователям и помни, что моему язделию нужно 17 ядер,
проприетарная тайваньская операционная система, 400 энв переменных, 2 конфига в xml,
один конфиг на прологе, 2 ТБ места на локальном диске и 4 базы данных.
И да язделие должно быть в проде через 2 дня, а документацию доступна у меня через нейроинтерфейс.”_

Нужно поменять всего лишь немного:

_“я **собираюсь** сделять. Моему язделию нужно будет предположительно 17 ядер,
проприетарная тайваньская операционная система, несколько сотен энв переменных, конфиги на xml и прологе,
пару ТБ места на локальном диске и 4 разных базы данных.
И да язделие должно быть в проде к дате дд.мм.гггг. Документацию писать мы пока не планировали.”_

Ситуация, описанная выше гиперболизирована, но это попытка наглядно показать разницу - вместо того, чтобы ставить перед фактом и передавать что-то в эксплуатацию, мы начинаем разговор перед тем, как что-то делать.

## Какова цель этого разговора?

Основное --- это админам понять потребности команды разработки и команде разработки понять возможности инфраструктуры.
Упрощая, поставить себя на место собеседника.

Всё. Эта цель и есть основа того самого DevOps процесса. На самом деле DevOps просто термин, который придумали, чтобы легко ~~вписать в описание конференции~~ можно было сгруппировать дальнейшие действия,
в котором будут рождаться процессы и инструменты для решения существующих в то время проблем.

Но если убрать отсюда термин, то описанная выше цель и есть начало здоровой и продуктивной командной разработки.
*А также причина почему увеличение количества людей не приводит к пропорциональному росту скорости, но это другая история.*

И у админов, и у разработчиков есть те самые сакральные знания, которые по умолчанию недоступны другой стороне.
Понимая и цели, и возможности друг друга, команды смогут прийти к компромиссу, когда одним не нужно жертвовать бизнес требованиями,
а у других кровь из глаз не льется в попытках понять что происходит и успеть к срокам. Главное сделать глубокий вдох перед началом...

## А где же инструменты?

Инструменты, которыми мы сейчас пользуемся и которые уже принято вкладывать в термин DevOps рождались как раз-таки во время тех самых разговоров.
Т. е. поднять кубернетисы и запихать всё в контейнеры не является самоцелью процесса. Целью является понять, что команды создают систему именно так,
потому что у них есть на то причины, и совместно согласиться как спрос на инфраструктуру для этой самой системы может быть покрыт в процессе разработки.
В результате этих разговоров - обе стороны должны понимать, что дальше делать и причины этих поступков.
Те самые кубернетисы так и рождались, новые разработчики прибывали, бизнес хотел всё больше,
а наращивать админов и подходить к настройке каждого сервера с небольшой ноткой романтизма, когда сервера для одного и того же,
но настроены немного по-разному, не было радикальным ответом на такой рост.
И тогда же сразу научились паппетами и шефами разливать идентичную инфраструктуру, потом добавили еще динамики и запихали все приложения
под оркестраторы, в котором целый мир для приложений встроен из коробки.
Но еще раз, **всё это было ответом на конкретные проблемы, зачастую в контексте конкретных организаций**.
Конечно, некоторые проблемы были более распространенные, поэтому часть инструментом теперь запихивается по умолчанию во многих проектах.

## Почему кубернетесы с терраформами всё еще не являются решением той самой изначальной проблемы?

Несмотря на то, что с высоты птичьего полёта проблемы у разных проектов схожие, каждый день мы работаем на более низком уровне.
Мы не говорим про continuous delivery, как нечто абстрактное. Мы говорим о том, что нам нужно доставлять приложения,
которые мы делаем **в контексте** текущего проекта, организации, продукта и т. д.
В одном случае у продукта могут быть сотни запросов в секунду и каждое движение на продакшене нужно делать аккуратно и развозить поэтапно,
размазывая увеличение нагрузки на новую версию на день или два, в другом случае нам нужно чтобы траффик как можно быстрее пошел на новую версию.
И в таких случаях мы возвращаемся к тому же взаимодействию, что и в далеком 2009, только предмет разговора немного поменялся.
Общение ведется не в сторону, а дайте нам серверов разных, да побольше, а дайте нам возможность решить задачу Х,
так как это нужно для нашего контекста. Несмотря на то, что повсеместное применение публичных облаков сильно смягчает ситуацию,
такие разговоры всё равно никуда не делись. Причины могут быть разные: наследие в системах, попадание под государственные регуляции,
поддержка различных стандартов и т. д.

## К чему это всё?

К тому что пока в рамках взаимодействий мы не научимся проводить те самые разговоры, в нужное время и приходить к решению,
которое устраивает все стороны, то никакого девопса в процессах нету.
Есть просто набор инструментов, которые решают из коробки какие-то широко распространенные в индустрии проблемы.

Но если все научатся договариваться между друг-другом, то тогда у нас резко уменьшится количество эффективных менеджеров,
архитекторов, девопс команд и начнётся реальная производительность и результаты.

Если сильно запутанно — то вот простое правило, с которого можно начать:

***Как результат всех коммуникаций между несколькими заинтересованными сторонами, все стороны должны понимать дальнейшие действия.***

При этом условное "пойти на ... север" не должно считаться как дальнейшие действия.

## Что это всё значит на примерах из жизни?

### Пример. Разрешите этому серверу ходить в эти подсети

#### Негативный сценарий:

Команда разработки: *нам нужно вызывать API X из сервера Y, но у них нету сетевой связности. Добавьте, пожалуйста, сетевую связность между ними.*

Команда инфраструктуры: *нет, эти сети не должны быть связанны.*

Занавес... Команда разработки не может достичь бизнес цели, все не довольны. Инфраструктурная команда думает, что они очередной раз спасли от компанию от ереси,
и представляют разработчиков малыми детьми. А разработчики думают, что админы вообще оторваны от всего что происходит, и не понятно, чем там вообще занимаются,
кроме того, что запрещают что-то делать. В итоге происходит эскалация, и кто-то начинает вникать в проблемы одних и других и найти решение, которое устроит обоих.

#### Позитивный сценарий:

Команда разработки: *к нам пришла задача, для которой нам надо вызывать API X из сервера Y.
Но мы обнаружили что между ними нету сетевой связности. Можем ли мы организовать эту связность?*

Команда инфраструктуры: *нет, у нас нарезанные уже доверенные сети. Между этими компонентами доверия не должно быть, по планам.
У вас есть возможность сделать задачу, не общаясь между этими 2мя серверами?*

Дальше следует общий мозговой штурм над альтернативами, в итоге понимают, что API не обязательно дергать на сервере,
и можно вызвать, например из браузера и для этого надо API выставить через gateway и расходятся, продолжая работу над своими задачами.

## В качестве заключения

Описанные тут слова и примеры могут выглядеть достаточно наивно и очевидно. Но я неоднократно наблюдал и был в похожих ситуациях,
когда 2-3 стороны заходят в тупик на первом же ветке общения, и нужно быть тем самым промежуточным звеном, которое пытается искать компромисс между всеми.
Если же мы поменяем немного то, как мы общаемся между инфраструктурой и разработки, то от этого могут получиться отличные решения и, иногда, даже инструменты мирового уровня.
